<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Davranış Karşılaştırma Testi — Benim Davranışlarım / Onun Davranışları</title>

  <style>
    :root {
      /* Profesyonel renk paleti */
      --bg: #ffffff;
      --text: #111827;
      --muted: #6b7280;
      --border: #e5e7eb;
      --soft: #f9fafb;
      --card-bg: #ffffff;
      --shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      --shadow-lg: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
      --radius: 12px;
      --radius-lg: 16px;
      
      /* Renk skalası 1-9 */
      --color-1: #f3f4f6;
      --color-2: #dbeafe;
      --color-3: #bfdbfe;
      --color-4: #93c5fd;
      --color-5: #60a5fa;
      --color-6: #3b82f6;
      --color-7: #2563eb;
      --color-8: #1d4ed8;
      --color-9: #1e40af;
      
      /* Ben ve O renkleri */
      --me-color: #3b82f6;
      --other-color: #ef4444;
    }

    * { 
      box-sizing: border-box;
      margin: 0;
    }

    body {
      margin: 0;
      background: var(--bg);
      color: var(--text);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Inter', sans-serif;
      line-height: 1.5;
      padding: 20px 16px;
      min-height: 100vh;
    }

    .wrap {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      gap: 24px;
    }

    /* ===== HEADER ===== */
    header {
      text-align: center;
      padding: 24px 0;
      margin-bottom: 8px;
    }

    h1 {
      margin: 0 0 12px 0;
      font-size: 28px;
      font-weight: 800;
      color: var(--text);
      letter-spacing: -0.5px;
    }

    .sub {
      margin: 0 auto;
      color: var(--muted);
      font-size: 15px;
      max-width: 600px;
      line-height: 1.6;
    }

    /* ===== PICKER-SLIDER KONTEYNIR ===== */
    .picker-container {
      display: grid;
      grid-template-columns: 1fr;
      gap: 24px;
      margin-bottom: 20px;
    }

    @media (min-width: 768px) {
      .picker-container {
        grid-template-columns: 1fr 1fr;
        gap: 32px;
      }
    }

    .picker-card {
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      background: var(--card-bg);
      padding: 24px;
      box-shadow: var(--shadow);
      transition: transform 0.2s ease;
    }

    .picker-card:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    .picker-card.me {
      border-top: 4px solid var(--me-color);
    }

    .picker-card.other {
      border-top: 4px solid var(--other-color);
    }

    .card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
      padding-bottom: 12px;
      border-bottom: 2px solid var(--soft);
    }

    .card-title {
      font-size: 18px;
      font-weight: 800;
      color: var(--text);
    }

    .card-title.me {
      color: var(--me-color);
    }

    .card-title.other {
      color: var(--other-color);
    }

    .progress {
      font-size: 14px;
      color: var(--muted);
      font-weight: 600;
    }

    .progress span {
      font-weight: 800;
      color: var(--text);
    }

    /* ===== PICKER STİLLERİ ===== */
    .picker-group {
      margin-bottom: 24px;
    }

    .picker-label {
      display: block;
      margin-bottom: 8px;
      font-size: 14px;
      font-weight: 700;
      color: var(--text);
    }

    .behavior-picker {
      width: 100%;
      padding: 14px 16px;
      font-size: 16px;
      border: 2px solid var(--border);
      border-radius: var(--radius);
      background: var(--soft);
      color: var(--text);
      font-weight: 600;
      cursor: pointer;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%236b7280' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 16px center;
      background-size: 16px;
    }

    .behavior-picker:focus {
      outline: none;
      border-color: var(--me-color);
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }

    .picker-card.other .behavior-picker:focus {
      border-color: var(--other-color);
      box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
    }

    /* ===== SLIDER STİLLERİ ===== */
    .slider-group {
      margin-bottom: 32px;
    }

    .slider-container {
      position: relative;
      margin: 20px 0 12px;
    }

    /* Gradient track */
    .slider-track {
      position: absolute;
      top: 50%;
      left: 0;
      right: 0;
      height: 8px;
      background: linear-gradient(to right, 
        var(--color-1), var(--color-3), var(--color-5), 
        var(--color-7), var(--color-9));
      border-radius: 4px;
      transform: translateY(-50%);
      z-index: 1;
    }

    /* Custom slider */
    .behavior-slider {
      width: 100%;
      height: 40px;
      margin: 0;
      position: relative;
      z-index: 2;
      background: transparent;
      appearance: none;
      cursor: pointer;
    }

    .behavior-slider::-webkit-slider-thumb {
      appearance: none;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: white;
      border: 3px solid var(--me-color);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .behavior-slider::-webkit-slider-thumb:hover {
      transform: scale(1.1);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }

    .picker-card.other .behavior-slider::-webkit-slider-thumb {
      border-color: var(--other-color);
    }

    .behavior-slider::-moz-range-thumb {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: white;
      border: 3px solid var(--me-color);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
      cursor: pointer;
    }

    /* Slider değer göstergesi */
    .slider-value {
      text-align: center;
      font-size: 32px;
      font-weight: 800;
      color: var(--text);
      margin: 8px 0 4px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .slider-labels {
      display: flex;
      justify-content: space-between;
      margin-top: 8px;
      font-size: 12px;
      color: var(--muted);
      font-weight: 600;
    }

    .endpoint-labels {
      display: flex;
      justify-content: space-between;
      margin-top: 4px;
      font-size: 13px;
      color: var(--text);
      font-weight: 700;
    }

    /* ===== SAVE BUTTON ===== */
    .save-btn {
      width: 100%;
      padding: 16px;
      font-size: 16px;
      font-weight: 700;
      border: none;
      border-radius: var(--radius);
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      margin-top: 8px;
    }

    .save-btn.me {
      background: var(--me-color);
      color: white;
    }

    .save-btn.other {
      background: var(--other-color);
      color: white;
    }

    .save-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }

    .save-btn:active {
      transform: translateY(0);
    }

    .save-btn.saved {
      background: #10b981;
    }

    /* ===== GRAFİKLER ===== */
    .charts-section {
      margin-top: 16px;
    }

    .charts-container {
      display: grid;
      grid-template-columns: 1fr;
      gap: 20px;
    }

    @media (min-width: 768px) {
      .charts-container {
        grid-template-columns: 1fr 1fr;
      }
    }

    .chart-card {
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: 20px;
      background: var(--card-bg);
      box-shadow: var(--shadow);
      min-height: 320px;
    }

    .chart-title {
      margin: 0 0 16px 0;
      font-size: 16px;
      font-weight: 800;
      color: var(--text);
      text-align: center;
    }

    .chart-placeholder {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 250px;
      color: var(--muted);
      font-size: 14px;
      text-align: center;
      padding: 20px;
    }

    /* ===== KARŞILAŞTIRMA ve ÖNERİLER ===== */
    .results-section {
      display: grid;
      grid-template-columns: 1fr;
      gap: 20px;
      margin-top: 16px;
    }

    @media (min-width: 992px) {
      .results-section {
        grid-template-columns: 1fr 1fr;
      }
    }

    .results-card {
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: 24px;
      background: var(--card-bg);
      box-shadow: var(--shadow);
    }

    .results-card h3 {
      margin: 0 0 20px 0;
      font-size: 18px;
      font-weight: 800;
      color: var(--text);
      padding-bottom: 12px;
      border-bottom: 2px solid var(--soft);
    }

    .comparison-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .comparison-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 0;
      border-bottom: 1px solid var(--soft);
    }

    .comparison-item:last-child {
      border-bottom: none;
    }

    .item-name {
      font-weight: 700;
      color: var(--text);
      font-size: 14px;
    }

    .item-values {
      display: flex;
      gap: 12px;
      font-weight: 800;
      font-size: 14px;
    }

    .me-value {
      color: var(--me-color);
    }

    .other-value {
      color: var(--other-color);
    }

    .diff-value {
      background: #10b981;
      color: white;
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 13px;
    }

    .recommendation-item {
      padding: 16px;
      background: var(--soft);
      border-radius: var(--radius);
      margin-bottom: 12px;
      border-left: 4px solid var(--me-color);
    }

    .recommendation-item h4 {
      margin: 0 0 8px 0;
      font-size: 15px;
      color: var(--text);
    }

    .recommendation-item p {
      margin: 0;
      font-size: 14px;
      color: var(--muted);
      line-height: 1.5;
    }

    /* ===== FOOTER ===== */
    footer {
      margin-top: 32px;
      padding-top: 20px;
      border-top: 1px solid var(--border);
      text-align: center;
      color: var(--muted);
      font-size: 13px;
    }

    /* ===== UTILITIES ===== */
    .hidden {
      display: none !important;
    }

    .completed .card-title::after {
      content: " ✓";
      color: #10b981;
    }
  </style>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>

<body>
  <div class="wrap">
    <header>
      <h1>Davranış Karşılaştırma Testi</h1>
      <p class="sub">Davranışınızı seçin, şiddetini kaydırıcı ile belirleyin. Hem kendiniz hem karşınızdaki için değerlendirme yapın.</p>
    </header>

    <!-- PICKER-SLIDER BÖLÜMÜ -->
    <div class="picker-container">
      <!-- BENİM DAVRANIŞLARIM -->
      <div class="picker-card me" id="meCard">
        <div class="card-header">
          <h2 class="card-title me">Benim Davranışlarım</h2>
          <div class="progress">Tamamlanan: <span id="meCount">0</span>/8</div>
        </div>

        <div class="picker-group">
          <label class="picker-label">Davranış Seçin</label>
          <select class="behavior-picker" id="mePicker">
            <option value="">Bir davranış seçin</option>
            <!-- JS ile doldurulacak -->
          </select>
        </div>

        <div class="slider-group">
          <div class="slider-container">
            <div class="slider-track"></div>
            <input type="range" min="1" max="9" value="5" 
                   class="behavior-slider" id="meSlider">
          </div>
          
          <div class="slider-value" id="meValue">5</div>
          
          <div class="slider-labels">
            <span>1</span><span>2</span><span>3</span><span>4</span>
            <span>5</span><span>6</span><span>7</span><span>8</span><span>9</span>
          </div>
          
          <div class="endpoint-labels">
            <span id="meLowLabel">Az</span>
            <span id="meHighLabel">Çok</span>
          </div>
        </div>

        <button class="save-btn me" id="meSaveBtn">
          <span>Kaydet</span>
        </button>
      </div>

      <!-- ONUN DAVRANIŞLARI -->
      <div class="picker-card other" id="otherCard">
        <div class="card-header">
          <h2 class="card-title other">Onun Davranışları</h2>
          <div class="progress">Tamamlanan: <span id="otherCount">0</span>/8</div>
        </div>

        <div class="picker-group">
          <label class="picker-label">Davranış Seçin</label>
          <select class="behavior-picker" id="otherPicker">
            <option value="">Bir davranış seçin</option>
            <!-- JS ile doldurulacak -->
          </select>
        </div>

        <div class="slider-group">
          <div class="slider-container">
            <div class="slider-track"></div>
            <input type="range" min="1" max="9" value="5" 
                   class="behavior-slider" id="otherSlider">
          </div>
          
          <div class="slider-value" id="otherValue">5</div>
          
          <div class="slider-labels">
            <span>1</span><span>2</span><span>3</span><span>4</span>
            <span>5</span><span>6</span><span>7</span><span>8</span><span>9</span>
          </div>
          
          <div class="endpoint-labels">
            <span id="otherLowLabel">Az</span>
            <span id="otherHighLabel">Çok</span>
          </div>
        </div>

        <button class="save-btn other" id="otherSaveBtn">
          <span>Kaydet</span>
        </button>
      </div>
    </div>

    <!-- GRAFİKLER -->
    <section class="charts-section">
      <div class="charts-container">
        <div class="chart-card">
          <h3 class="chart-title">Benim Davranış Profilim</h3>
          <div class="chart-placeholder" id="meChartPlaceholder">
            Tüm davranışlarınızı kaydettikten sonra grafik burada görünecek.
          </div>
          <canvas id="meChart" class="hidden" height="260"></canvas>
        </div>
        
        <div class="chart-card">
          <h3 class="chart-title">Onun Davranış Profili</h3>
          <div class="chart-placeholder" id="otherChartPlaceholder">
            Tüm davranışları kaydettikten sonra grafik burada görünecek.
          </div>
          <canvas id="otherChart" class="hidden" height="260"></canvas>
        </div>
      </div>
    </section>

    <!-- KARŞILAŞTIRMA ve ÖNERİLER -->
    <section class="results-section">
      <div class="results-card">
        <h3>Karşılaştırma Sonuçları</h3>
        <div class="comparison-placeholder" id="comparisonPlaceholder">
          Her iki tarafın da tüm davranışları kaydedilince sonuçlar burada görünecek.
        </div>
        <ul class="comparison-list hidden" id="comparisonList"></ul>
      </div>
      
      <div class="results-card">
        <h3>Uyumlanma Önerileri</h3>
        <div class="recommendation-placeholder" id="recommendationPlaceholder">
          Farklılıklarınız analiz edilince öneriler burada görünecek.
        </div>
        <div class="recommendation-list hidden" id="recommendationList"></div>
      </div>
    </section>

    <footer>
      <p>Davranış Karşılaştırma Testi • Picker+Slider sistemi • Mobil optimizasyon</p>
    </footer>
  </div>

  <script>
    // ===== VERİ YAPILARI =====
    const behaviors = [
      "Konuşma Hızı",
      "Sesin Hacmi", 
      "Mimikler",
      "Göz Teması",
      "Ellerin Kullanımı",
      "Duruş",
      "İçerik",
      "Kelime Sayısı"
    ];

    const endpoints = {
      "Konuşma Hızı": { low: "Yavaş", high: "Hızlı" },
      "Sesin Harcmi": { low: "Zayıf", high: "Güçlü" },
      "Mimikler": { low: "Kontrollü", high: "Hareketli" },
      "Göz Teması": { low: "Dolaylı", high: "Doğrudan" },
      "Ellerin Kullanımı": { low: "Az", high: "Çok" },
      "Duruş": { low: "Çekingen", high: "Atak" },
      "İçerik": { low: "Hikayeler", high: "Gerçekler" },
      "Kelime Sayısı": { low: "Az", high: "Çok" }
    };

    const recommendations = {
      "Konuşma Hızı": {
        lowHigh: "Karşı taraf daha hızlı konuşuyor: Aktif duraklamalar yapın ve 'Anlatabildim mi?' gibi onay soruları kullanın.",
        highLow: "Siz daha hızlı konuşuyorsunuz: Cümleler arasında 1-2 saniye duraklayın, önemli noktaları tekrarlayın."
      },
      "Sesin Harcmi": {
        lowHigh: "Karşı tarafın sesi daha güçlü: Dik duruş ve diyafram nefesi ile sesinizi güçlendirin.",
        highLow: "Sizin sesiniz daha güçlü: Sesinizi kademeli olarak alçaltın, yumuşatıcı ifadeler kullanın."
      },
      // ... diğer davranışlar için benzer
    };

    // ===== STATE =====
    const mySelections = {};
    const otherSelections = {};
    
    let chartMeInstance = null;
    let chartOtherInstance = null;

    // ===== DOM ELEMENTS =====
    const mePicker = document.getElementById('mePicker');
    const otherPicker = document.getElementById('otherPicker');
    const meSlider = document.getElementById('meSlider');
    const otherSlider = document.getElementById('otherSlider');
    const meValue = document.getElementById('meValue');
    const otherValue = document.getElementById('otherValue');
    const meSaveBtn = document.getElementById('meSaveBtn');
    const otherSaveBtn = document.getElementById('otherSaveBtn');
    const meCount = document.getElementById('meCount');
    const otherCount = document.getElementById('otherCount');
    const meCard = document.getElementById('meCard');
    const otherCard = document.getElementById('otherCard');

    // ===== PICKER DOLDURMA =====
    function populatePickers() {
      behaviors.forEach(behavior => {
        const option1 = document.createElement('option');
        option1.value = behavior;
        option1.textContent = behavior;
        mePicker.appendChild(option1.cloneNode(true));
        
        const option2 = option1.cloneNode(true);
        otherPicker.appendChild(option2);
      });
    }

    // ===== SLIDER UPDATE =====
    function updateSliderValue(slider, valueDisplay) {
      const value = slider.value;
      valueDisplay.textContent = value;
      
      // Slider thumb rengini değiştir (1-9 arası gradient)
      const color = getColorForValue(value);
      slider.style.setProperty('--thumb-color', color);
    }

    function getColorForValue(value) {
      const colors = [
        '#f3f4f6', '#dbeafe', '#bfdbfe', '#93c5fd', 
        '#60a5fa', '#3b82f6', '#2563eb', '#1d4ed8', '#1e40af'
      ];
      return colors[value - 1] || colors[4];
    }

    // ===== ENDPOINT LABEL UPDATE =====
    function updateEndpointLabels(picker, lowLabel, highLabel) {
      const behavior = picker.value;
      if (endpoints[behavior]) {
        lowLabel.textContent = endpoints[behavior].low;
        highLabel.textContent = endpoints[behavior].high;
      } else {
        lowLabel.textContent = "Az";
        highLabel.textContent = "Çok";
      }
    }

    // ===== KAYDETME FONKSİYONU =====
    function saveSelection(type, behavior, value) {
      if (!behavior) {
        alert('Lütfen önce bir davranış seçin.');
        return false;
      }

      if (type === 'me') {
        mySelections[behavior] = parseInt(value);
        meSaveBtn.innerHTML = '<span>✓ Kaydedildi</span>';
        meSaveBtn.classList.add('saved');
      } else {
        otherSelections[behavior] = parseInt(value);
        otherSaveBtn.innerHTML = '<span>✓ Kaydedildi</span>';
        otherSaveBtn.classList.add('saved');
      }

      // 2 saniye sonra butonu eski haline getir
      setTimeout(() => {
        if (type === 'me') {
          meSaveBtn.innerHTML = '<span>Kaydet</span>';
          meSaveBtn.classList.remove('saved');
        } else {
          otherSaveBtn.innerHTML = '<span>Kaydet</span>';
          otherSaveBtn.classList.remove('saved');
        }
      }, 2000);

      updateProgress();
      checkCompletion();
      return true;
    }

    // ===== PROGRESS UPDATE =====
    function updateProgress() {
      const meCompleted = Object.keys(mySelections).length;
      const otherCompleted = Object.keys(otherSelections).length;
      
      meCount.textContent = meCompleted;
      otherCount.textContent = otherCompleted;
      
      // Kartı tamamlanmış olarak işaretle
      if (meCompleted === behaviors.length) {
        meCard.classList.add('completed');
      }
      if (otherCompleted === behaviors.length) {
        otherCard.classList.add('completed');
      }
    }

    // ===== TAMAMLAMA KONTROLÜ =====
    function checkCompletion() {
      const meCompleted = Object.keys(mySelections).length === behaviors.length;
      const otherCompleted = Object.keys(otherSelections).length === behaviors.length;
      
      // Grafikleri göster/gizle
      if (meCompleted) {
        document.getElementById('meChartPlaceholder').classList.add('hidden');
        document.getElementById('meChart').classList.remove('hidden');
        renderChart('meChart', mySelections, '#3b82f6');
      }
      
      if (otherCompleted) {
        document.getElementById('otherChartPlaceholder').classList.add('hidden');
        document.getElementById('otherChart').classList.remove('hidden');
        renderChart('otherChart', otherSelections, '#ef4444');
      }
      
      // Karşılaştırma ve önerileri göster
      if (meCompleted && otherCompleted) {
        document.getElementById('comparisonPlaceholder').classList.add('hidden');
        document.getElementById('comparisonList').classList.remove('hidden');
        document.getElementById('recommendationPlaceholder').classList.add('hidden');
        document.getElementById('recommendationList').classList.remove('hidden');
        
        renderComparison();
        renderRecommendations();
      }
    }

    // ===== GRAFİK RENDER =====
    function renderChart(canvasId, data, color) {
      const ctx = document.getElementById(canvasId);
      const labels = [];
      const values = [];
      
      behaviors.forEach(behavior => {
        labels.push(behavior);
        values.push(data[behavior] || 1);
      });
      
      // Mevcut chart'ı yok et
      const existingChart = Chart.getChart(ctx);
      if (existingChart) {
        existingChart.destroy();
      }
      
      // Yeni chart oluştur
      new Chart(ctx, {
        type: 'radar',
        data: {
          labels: labels,
          datasets: [{
            label: 'Şiddet',
            data: values,
            backgroundColor: color + '20',
            borderColor: color,
            borderWidth: 2,
            pointBackgroundColor: color,
            pointRadius: 4
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            r: {
              min: 1,
              max: 9,
              ticks: {
                stepSize: 1
              }
            }
          },
          plugins: {
            legend: {
              display: false
            }
          }
        }
      });
    }

    // ===== KARŞILAŞTIRMA RENDER =====
    function renderComparison() {
      const list = document.getElementById('comparisonList');
      list.innerHTML = '';
      
      behaviors.forEach(behavior => {
        const myVal = mySelections[behavior] || 0;
        const otherVal = otherSelections[behavior] || 0;
        const diff = myVal - otherVal;
        
        if (myVal > 0 && otherVal > 0) {
          const li = document.createElement('li');
          li.className = 'comparison-item';
          
          li.innerHTML = `
            <span class="item-name">${behavior}</span>
            <div class="item-values">
              <span class="me-value">${myVal}</span>
              <span class="other-value">${otherVal}</span>
              ${diff > 0 ? `<span class="diff-value">+${diff}</span>` : ''}
            </div>
          `;
          
          list.appendChild(li);
        }
      });
    }

    // ===== ÖNERİLER RENDER =====
    function renderRecommendations() {
      const container = document.getElementById('recommendationList');
      container.innerHTML = '';
      
      behaviors.forEach(behavior => {
        const myVal = mySelections[behavior] || 0;
        const otherVal = otherSelections[behavior] || 0;
        
        if (myVal > 0 && otherVal > 0 && myVal !== otherVal) {
          const diffType = myVal > otherVal ? 'highLow' : 'lowHigh';
          const recommendation = recommendations[behavior]?.[diffType];
          
          if (recommendation) {
            const div = document.createElement('div');
            div.className = 'recommendation-item';
            div.innerHTML = `
              <h4>${behavior}</h4>
              <p>${recommendation}</p>
            `;
            container.appendChild(div);
          }
        }
      });
    }

    // ===== EVENT LISTENERS =====
    document.addEventListener('DOMContentLoaded', () => {
      // Picker'ları doldur
      populatePickers();
      
      // Slider değerlerini başlat
      updateSliderValue(meSlider, meValue);
      updateSliderValue(otherSlider, otherValue);
      
      // Endpoint label'ları başlat
      updateEndpointLabels(mePicker, 
        document.getElementById('meLowLabel'),
        document.getElementById('meHighLabel'));
      updateEndpointLabels(otherPicker,
        document.getElementById('otherLowLabel'),
        document.getElementById('otherHighLabel'));
      
      // Slider değişimleri
      meSlider.addEventListener('input', () => updateSliderValue(meSlider, meValue));
      otherSlider.addEventListener('input', () => updateSliderValue(otherSlider, otherValue));
      
      // Picker değişimleri
      mePicker.addEventListener('change', function() {
        updateEndpointLabels(this, 
          document.getElementById('meLowLabel'),
          document.getElementById('meHighLabel'));
        // Eğer bu davranış daha önce kaydedildiyse, slider'ı o değere getir
        if (mySelections[this.value]) {
          meSlider.value = mySelections[this.value];
          updateSliderValue(meSlider, meValue);
        }
      });
      
      otherPicker.addEventListener('change', function() {
        updateEndpointLabels(this,
          document.getElementById('otherLowLabel'),
          document.getElementById('otherHighLabel'));
        if (otherSelections[this.value]) {
          otherSlider.value = otherSelections[this.value];
          updateSliderValue(otherSlider, otherValue);
        }
      });
      
      // Kaydet butonları
      meSaveBtn.addEventListener('click', () => {
        const behavior = mePicker.value;
        const value = meSlider.value;
        if (saveSelection('me', behavior, value)) {
          // Sonraki davranışa geç (sırayla)
          const currentIndex = behaviors.indexOf(behavior);
          const nextIndex = (currentIndex + 1) % behaviors.length;
          mePicker.value = behaviors[nextIndex];
          mePicker.dispatchEvent(new Event('change'));
        }
      });
      
      otherSaveBtn.addEventListener('click', () => {
        const behavior = otherPicker.value;
        const value = otherSlider.value;
        if (saveSelection('other', behavior, value)) {
          const currentIndex = behaviors.indexOf(behavior);
          const nextIndex = (currentIndex + 1) % behaviors.length;
          otherPicker.value = behaviors[nextIndex];
          otherPicker.dispatchEvent(new Event('change'));
        }
      });
      
      // Klavye kısayolları
      document.addEventListener('keydown', (e) => {
        if (e.target.tagName === 'SELECT' || e.target.tagName === 'INPUT') return;
        
        if (e.key === '1') meSlider.value = 1;
        else if (e.key === '2') meSlider.value = 2;
        else if (e.key === '3') meSlider.value = 3;
        else if (e.key === '4') meSlider.value = 4;
        else if (e.key === '5') meSlider.value = 5;
        else if (e.key === '6') meSlider.value = 6;
        else if (e.key === '7') meSlider.value = 7;
        else if (e.key === '8') meSlider.value = 8;
        else if (e.key === '9') meSlider.value = 9;
        
        updateSliderValue(meSlider, meValue);
      });
    });
  </script>
</body>
</html>